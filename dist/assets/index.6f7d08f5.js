import{G as he}from"./GiTitle.fbc5d32a.js";import{ak as ye,g,z as Ce,A as X,d as M,H as te,o as A,c as S,w as t,aa as ae,i as k,W as we,j as N,ap as Fe,ad as ke,au as xe,_ as q,J as Y,a as K,s as j,r as o,h as e,e as C,b as L,f8 as De,f9 as be,av as Be,at as ue,U as Ee,F as Ae,f as $e,t as le,x as Te,p as Ie,l as Ve,u as ze,f1 as Se,ao as Ne}from"./index.9e0cf28f.js";import"./index.463d26de.js";import{u as Me}from"./usePagination.f69fc943.js";import"./viewer.11af2ccb.js";import{o as Oe,d as Pe,g as Re}from"./index.6a3807e1.js";import{a as He,G as J}from"./GiOptionItem.beb14780.js";import{g as Ge}from"./index.eb372bec.js";const Ue="/mock";function We(){return ye.get(`${Ue}/cate/tree`)}function je(r,_,i={alignPoint:!1}){const a=g(!1),m=g(0),c=g(0),u=p=>{a.value=p},f=()=>{const p={};return r.clientX>window.innerWidth-c.value?p.right=i.alignPoint?window.innerWidth-r.clientX-m.value/2+"px":window.innerWidth-r.clientX+"px":p.left=i.alignPoint?r.clientX+m.value/2+"px":r.clientX+"px",r.clientY>window.innerHeight-c.value?(p.bottom=window.innerHeight-r.clientY+"px",p["transform-origin"]="center bottom"):(p.top=r.clientY+2+"px",p["transform-origin"]="center top"),p["z-index"]=999,p};return Ce(()=>{a.value=!0,X(()=>{!_||(c.value=_==null?void 0:_.offsetHeight,m.value=_==null?void 0:_.offsetWidth,f())})}),{visible:a,setVisible:u,getStyle:f}}function Xe(r,_="\u65B0\u5EFA\u5206\u7C7B"){let i=0;for(let a=0;a<r.length+1;a++)if(!r.includes(`${_}${a+1}`)){i=a+1;break}return`${_}${i}`}const qe=M({name:"GiContextMenu"}),Le=M({...qe,props:{event:{},options:{},ignoreRefs:{}},emits:["close"],setup(r,{expose:_,emit:i}){const a=r,m=g(null),{visible:c,setVisible:u,getStyle:f}=je(a.event,m,a.options);Oe(m,()=>{u(!1),i("close")},{capture:!1,ignore:a.ignoreRefs});const{width:p,height:x}=Pe();return te(()=>[p.value,x.value],()=>{u(!1),i("close")}),_({visible:c,onHidden:()=>{u(!1),i("close")}}),(w,h)=>(A(),S(xe,{name:"slide-dynamic-origin"},{default:t(()=>[ae(k("div",{class:"gi-context-menu",ref_key:"elRef",ref:m,style:we(N(f)())},[Fe(w.$slots,"default",{},void 0,!0)],4),[[ke,N(c)]])]),_:3}))}});const Je=q(Le,[["__scopeId","data-v-8df5b62b"]]),Ye={id:"movetree",ref:"moveTreeRef",class:"ztree move-tree"},Ke=M({__name:"MoveTree",props:{treeData:{type:Array,default:()=>[]}},emits:["node-click"],setup(r,{emit:_}){const i=r,a=g(null),m=Y({callback:{onClick:(u,f,p)=>{c(u,f,p)}}});te(i.treeData,()=>{X(()=>{var u;a.value=$.fn.zTree.init($("#movetree"),m,i.treeData),(u=a.value)==null||u.expandAll(!0)})},{deep:!0,immediate:!0});function c(u,f,p){_("node-click",p)}return(u,f)=>(A(),K("ul",Ye,null,512))}}),Qe=M({__name:"Menu",props:{event:{},fileInfo:{},treeData:{},onClose:{},onClick:{}},setup(r,{expose:_}){const i=r,a=g(null),m=g(null),c=g([m]),u=g(!1),f=j(()=>i.fileInfo.id!==""),p=j(()=>i.fileInfo.id!=="root"),x=j(()=>i.fileInfo.id!=="root"),T=j(()=>i.fileInfo.id!=="root"),w=()=>{u.value=!1,i.onClose()},h=F=>{if(F==="move")return u.value=!u.value,!1;X(()=>{var y;i.onClick(F),(y=a.value)==null||y.onHidden()})},I=()=>{var F;(F=a.value)==null||F.onHidden()};return _({menuRef:a,showMoveTreePopup:u,onClose:w,onClickItem:h}),(F,y)=>{const V=o("a-popover");return A(),S(Je,{ref_key:"menuRef",ref:a,event:F.event,ignoreRefs:c.value,onClose:w},{default:t(()=>[e(He,{width:"110",ref:"optionRef",style:{position:"relative"}},{default:t(()=>[f.value?(A(),S(J,{key:0,icon:"IconPlusCircle",onClick:y[0]||(y[0]=l=>h("add"))},{default:t(()=>[C("\u65B0\u589E")]),_:1})):L("",!0),p.value?(A(),S(J,{key:1,icon:"IconEdit",onClick:y[1]||(y[1]=l=>h("rename"))},{default:t(()=>[C("\u91CD\u547D\u540D")]),_:1})):L("",!0),e(V,{position:"right",trigger:"click","content-style":{padding:0,overflow:"hidden"},"unmount-on-close":!1,"popup-visible":u.value},{content:t(()=>[k("section",{class:"move-tree-box",ref_key:"moveTreeBoxRef",ref:m},[e(Ke,{"tree-data":F.treeData,onNodeClick:I},null,8,["tree-data"])],512)]),default:t(()=>[x.value?(A(),S(J,{key:0,more:"",icon:"IconExport",active:u.value,onClick:y[2]||(y[2]=l=>h("move"))},{default:t(()=>[C(" \u79FB\u52A8 ")]),_:1},8,["active"])):L("",!0)]),_:1},8,["popup-visible"]),T.value?(A(),S(J,{key:2,icon:"IconDelete",onClick:y[3]||(y[3]=l=>h("delete"))},{default:t(()=>[C("\u5220\u9664")]),_:1})):L("",!0)]),_:1},512)]),_:1},8,["event","ignoreRefs"])}}});const Ze=q(Qe,[["__scopeId","data-v-694d204a"]]);let R=null,G=null;function et(r,_,i){return new Promise(a=>{m(),G=document.createElement("div"),document.body.appendChild(G),R=De(Ze,{event:r,fileInfo:_,treeData:i,onClick:c=>{a({mode:c,fileInfo:_}),setTimeout(()=>{m()},360)},onClose:()=>{setTimeout(()=>{m()},360)}}),R.use(be),R.use(Be),R.mount(G);function m(){R!==null&&(R.unmount(),R=null),G!==null&&(document.body.removeChild(G),G=null)}})}const ee="/assets/com-file-open.4a2fe0e2.svg",W="/assets/com-file-close.e0ebbcc4.svg",tt="/assets/com-file.535b48e7.svg",nt={class:"cate-tree"},ot={class:"search-wrap"},at={class:"wrap"},ut=M({__name:"index",props:{type:{type:Number,default:1},placeholder:{type:String,default:"\u8BF7\u8F93\u5165\u5173\u952E\u8BCD"}},emits:["node-click"],setup(r,{emit:_}){const i=g(!1),a=g(""),m=g(null),c=g([]),u=g(null),f=g(null),p=(l,d,s)=>{console.log("\u70B9\u51FB\u8282\u70B9",s),f.value=s,_("node-click")},x=Y({callback:{onRightClick:(l,d,s)=>{console.log("\u9F20\u6807\u53F3\u952E",s),s&&(f.value=s,et(l,s,c.value).then(n=>{console.log("res",n),n.mode==="add"&&h(),n.mode==="rename"&&I(),n.mode==="delete"&&F()}))},onClick:(l,d,s)=>{p(l,d,s)}}}),T=l=>{if(!l.length)return;function d(s){s.forEach(n=>{n.children&&n.children.length?(n.iconOpen=ee,n.iconClose=W,d(n.children)):(n.children=null,n.iconOpen=ee,n.iconClose=W,n.icon=W,n.type==null&&(n.icon=tt))})}d(l)};(async()=>{try{i.value=!0;const l=await We();if(l.success){const d=l.data;T(d),c.value=d,X(()=>{var s;u.value=$.fn.zTree.init($("#treeDemo"),x,c.value),(s=u.value)==null||s.expandAll(!0)})}}catch(l){return l}finally{i.value=!1}})();const h=()=>{var D,H,O;const l=((D=f.value)==null?void 0:D.children)||[];let d="\u65B0\u5EFA\u5206\u7C7B1";if(l&&l.length){const z=l.map(E=>E.name);d=Xe(z,"\u65B0\u5EFA\u5206\u7C7B")}const s=new Date().getTime().toString(),n={id:s,name:d,children:null,iconOpen:ee,iconClose:W,icon:W,isParent:!1};(H=u.value)==null||H.addNodes(f.value||{},n,!0);const v=(O=u.value)==null?void 0:O.getNodesByParam("id",s);setTimeout(()=>{var z;(z=u.value)==null||z.editName(v[0])},100)},I=()=>{X(()=>{var d,s,n;const l=(s=u.value)==null?void 0:s.getNodesByParam("id",(d=f.value)==null?void 0:d.id);(n=u.value)==null||n.editName(l[0])})},F=()=>{ue.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",hideCancel:!1})},y=(l,d)=>{let s=!1;if(l.name.indexOf(d)>-1&&(s=!0),l.children){const n=l.children;for(let v=0;v<n.length;v++){const D=n[v];y(D,d)?s=!0:n.splice(v--,1)}}return s},V=()=>{var d,s;let l=a.value;if(!l)u.value=$.fn.zTree.init($("#treeDemo"),x,c.value),(d=u.value)==null||d.expandAll(!0);else{const n=JSON.parse(JSON.stringify(c.value));for(let v=0;v<n.length;v++)y(n[v],l)||n.splice(v--,1);u.value=$.fn.zTree.init($("#treeDemo"),x,n),(s=u.value)==null||s.expandAll(!0)}};return(l,d)=>{const s=o("icon-search"),n=o("a-input");return A(),K("div",nt,[k("div",ot,[e(n,{"allow-clear":"",maxlength:20,placeholder:r.placeholder,modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=v=>a.value=v),onInput:V,onClear:V},{prefix:t(()=>[e(s)]),_:1},8,["placeholder","modelValue"])]),k("div",at,[k("ul",{id:"treeDemo",ref_key:"treeRef",ref:m,class:"ztree cate-ztree"},null,512)])])}}});const lt=q(ut,[["__scopeId","data-v-9dfbdcde"]]),ne=r=>(Ie("data-v-48b17174"),r=r(),Ve(),r),st=ne(()=>k("div",null,"\u4EC5\u652F\u6301\u4E2D\u6587\u59D3\u540D",-1)),it=ne(()=>k("span",null,"\u6743\u9650\u914D\u7F6E",-1)),ct=ne(()=>k("span",null,"\u81EA\u5B9A\u4E49\u7BA1\u7406\u5458\u3001\u7F16\u8F91\u8005\u7684\u6743\u9650\uFF0C \u70B9\u51FB",-1)),rt=M({__name:"EditDialog",props:{modelValue:{type:Boolean,default:!1},formData:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(r,{emit:_}){const i=r,a=Re(i,"modelValue",_),m=[{name:"\u65B0\u589E"},{name:"\u7F16\u8F91"},{name:"\u91CD\u547D\u540D"},{name:"\u5206\u4EAB"},{name:"\u5220\u9664"}],c=Y({name:"",address:"",status:!1}),u=Y({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D"},{minLength:1,maxLength:4,message:"\u540D\u5B57\u6700\u957F\u4E0D\u8D85\u8FC74\u4E2A\u5B57\u7B26"}],status:[{required:!0}]}),f=j(()=>!!i.formData.id);te(a,()=>{const{name:T,address:w,status:h}=i.formData;c.name=T,c.address=w,c.status=h||!1});const p=()=>{a.value=!1},x=()=>{a.value=!1};return(T,w)=>{const h=o("a-input"),I=o("a-form-item"),F=o("a-radio"),y=o("a-radio-group"),V=o("a-form"),l=o("icon-question-circle-fill"),d=o("a-link"),s=o("a-tooltip"),n=o("a-space"),v=o("icon-right"),D=o("a-checkbox"),H=o("a-checkbox-group"),O=o("a-row"),z=o("a-collapse-item"),E=o("a-collapse"),Q=o("a-modal");return A(),S(Q,{visible:N(a),"onUpdate:visible":w[3]||(w[3]=b=>Te(a)?a.value=b:null),title:f.value?"\u7F16\u8F91":"\u65B0\u589E",onOk:x,onCancel:p},{default:t(()=>[e(V,{ref:"formRef",model:c,style:{width:"450px"}},{default:t(()=>[e(I,{field:"name",label:"\u59D3\u540D",rules:u.name},{extra:t(()=>[st]),default:t(()=>[e(h,{modelValue:c.name,"onUpdate:modelValue":w[0]||(w[0]=b=>c.name=b),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",style:{width:"280px"}},null,8,["modelValue"])]),_:1},8,["rules"]),e(I,{field:"address",label:"\u5730\u5740"},{default:t(()=>[e(h,{modelValue:c.address,"onUpdate:modelValue":w[1]||(w[1]=b=>c.address=b),placeholder:"\u8BF7\u8F93\u5165\u5730\u5740",style:{width:"280px"}},null,8,["modelValue"])]),_:1}),e(I,{field:"status",label:"\u72B6\u6001",rules:u.status},{default:t(()=>[e(y,{modelValue:c.status,"onUpdate:modelValue":w[2]||(w[2]=b=>c.status=b)},{default:t(()=>[e(F,{value:!1},{default:t(()=>[C("\u5173\u95ED")]),_:1}),e(F,{value:!0},{default:t(()=>[C("\u5F00\u542F")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"]),e(E,{bordered:!1,"default-active-key":["1"]},{default:t(()=>[e(z,{"show-expand-icon":!0,key:"1"},{header:t(()=>[e(n,null,{default:t(()=>[it,e(s,{position:"right","content-style":{width:"200px"}},{content:t(()=>[ct,e(d,{type:"primary"},{default:t(()=>[C("\u4E86\u89E3\u66F4\u591A\u6743\u9650")]),_:1})]),default:t(()=>[e(l,{style:{color:"rgb(var(--warning-6))"}})]),_:1})]),_:1})]),"expand-icon":t(({active:b})=>[e(v,{class:Ee({gi_rotate_90deg:b})},null,8,["class"])]),default:t(()=>[(A(),K(Ae,null,$e(m,(b,U)=>e(O,{justify:"space-between",key:U},{default:t(()=>[k("span",null,le(b.name),1),e(H,null,{default:t(()=>[e(D,{value:"1"},{default:t(()=>[C("\u7BA1\u7406\u5458")]),_:1}),e(D,{value:"2"},{default:t(()=>[C("\u7F16\u8F91\u8005")]),_:1})]),_:1})]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["visible","title"])}}});const dt=q(rt,[["__scopeId","data-v-48b17174"]]),_t={class:"manage"},pt={class:"tab"},mt={class:"gi_lr_page wrap"},ft={class:"left"},vt={class:"right"},gt={class:"content"},ht={class:"table-box"},yt=M({name:"IndicatorManage"}),Ct=M({...yt,setup(r){const _=ze(),{current:i,pageSize:a,total:m,changeCurrent:c,changePageSize:u,setTotal:f}=Me(()=>{h()}),p=g("2"),x=g([]),T=g(!1),w=n=>n<30?"danger":n<60?"warning":"success",h=async()=>{try{T.value=!0;const n=await Ge({current:i.value,pageSize:a.value});x.value=n.data.list,f(n.data.total)}catch(n){return n}finally{T.value=!1}};h();const I=()=>{ue.warning({title:"\u63D0\u793A",content:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",hideCancel:!1,onOk:()=>{x.value=[]}})},F=g(!1),y=g({}),V=n=>{y.value=n,F.value=!0},l=()=>{F.value=!0},d=()=>{_.push({path:"/indicator/detail"})},s=n=>{Ne.success("\u5220\u9664\u6210\u529F")};return(n,v)=>{const D=o("a-tab-pane"),H=o("a-tabs"),O=he,z=o("icon-plus"),E=o("a-button"),Q=o("icon-delete"),b=o("icon-download"),U=o("a-space"),Z=o("a-option"),se=o("a-select"),ie=o("a-input"),ce=o("icon-search"),re=o("a-input-group"),de=o("icon-refresh"),oe=o("a-row"),P=o("a-table-column"),_e=o("a-progress"),pe=o("a-switch"),me=o("a-popconfirm"),fe=o("a-table"),ve=Se("loading");return A(),K("div",_t,[k("section",pt,[e(H,{"hide-content":"",size:"medium","active-key":p.value,"onUpdate:activeKey":v[0]||(v[0]=B=>p.value=B)},{default:t(()=>[e(D,{key:"1",title:"\u539F\u5B50\u6307\u6807\u7BA1\u7406"}),e(D,{key:"2",title:"\u65F6\u95F4\u5468\u671F\u7BA1\u7406"}),e(D,{key:"3",title:"\u7EF4\u5EA6\u7BA1\u7406"}),e(D,{key:"4",title:"\u8BA1\u91CF\u5355\u4F4D\u7BA1\u7406"}),e(D,{key:"5",title:"\u6D3E\u751F\u6307\u6807\u7BA1\u7406"})]),_:1},8,["active-key"])]),k("section",mt,[k("div",ft,[e(O,{title:"\u6307\u6807\u5206\u7C7B"}),e(lt,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD",onNodeClick:h})]),k("div",vt,[e(O,{title:"\u6307\u6807\u5217\u8868"}),k("div",gt,[e(oe,{justify:"space-between",style:{"margin-bottom":"12px"}},{default:t(()=>[e(U,null,{default:t(()=>[e(E,{type:"primary",onClick:l},{icon:t(()=>[e(z)]),_:1}),e(E,{type:"primary",status:"danger",onClick:I},{icon:t(()=>[e(Q)]),default:t(()=>[C("\u5220\u9664")]),_:1}),e(E,{type:"primary",status:"success"},{icon:t(()=>[e(b)]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(se,{class:"gi_select_input",placeholder:"\u8BF7\u9009\u62E9","trigger-props":{updateAtScroll:!0}},{default:t(()=>[e(Z,null,{default:t(()=>[C("\u5317\u4EAC")]),_:1}),e(Z,null,{default:t(()=>[C("\u4E0A\u6D77")]),_:1}),e(Z,null,{default:t(()=>[C("\u5E7F\u5DDE")]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(ie,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD","allow-clear":""}),e(E,{type:"primary",onClick:h},{default:t(()=>[e(ce)]),_:1})]),_:1}),e(E,{type:"primary",onClick:h},{icon:t(()=>[e(de)]),_:1})]),_:1})]),_:1}),k("section",ht,[ae((A(),S(fe,{"row-key":"id",bordered:{cell:!0},data:x.value,scroll:{x:"100%",y:"100%",minWidth:1e3},"row-selection":{type:"checkbox",showCheckedAll:!0},pagination:{showPageSize:!0,total:N(m),current:N(i),pageSize:N(a)},onPageChange:N(c),onPageSizeChange:N(u)},{columns:t(()=>[e(P,{title:"\u5E8F\u53F7",width:68},{cell:t(B=>[C(le(B.rowIndex+1),1)]),_:1}),e(P,{title:"\u59D3\u540D","data-index":"name"}),e(P,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"startTime",width:180}),e(P,{title:"\u5730\u5740","data-index":"address",ellipsis:"",tooltip:""}),e(P,{title:"\u6BD4\u4F8B",width:200},{cell:t(({record:B})=>[e(_e,{status:w(B.proportion),percent:B.proportion/100},null,8,["status","percent"])]),_:1}),e(P,{title:"\u72B6\u6001",width:100},{cell:t(({record:B})=>[e(pe,{"model-value":B.status,size:"medium"},{checked:t(()=>[C("\u5F00\u542F")]),unchecked:t(()=>[C("\u5173\u95ED")]),_:2},1032,["model-value"])]),_:1}),e(P,{title:"\u64CD\u4F5C",width:200,align:"center"},{cell:t(({record:B})=>[e(oe,{justify:"center"},{default:t(()=>[e(U,null,{default:t(()=>[e(E,{type:"primary",size:"mini",onClick:ge=>V(B)},{default:t(()=>[C("\u4FEE\u6539")]),_:2},1032,["onClick"]),e(E,{size:"mini",onClick:d},{default:t(()=>[C("\u8BE6\u60C5")]),_:1}),e(me,{type:"warning",content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u9879\u5417?",onOk:ge=>s(B)},{default:t(()=>[e(E,{type:"primary",status:"danger",size:"mini"},{default:t(()=>[C("\u5220\u9664")]),_:1})]),_:2},1032,["onOk"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","pagination","onPageChange","onPageSizeChange"])),[[ve,T.value]])])])]),e(dt,{modelValue:F.value,"onUpdate:modelValue":v[1]||(v[1]=B=>F.value=B),"form-data":y.value},null,8,["modelValue","form-data"])])])}}});const At=q(Ct,[["__scopeId","data-v-762dee92"]]);export{At as default};
